<!doctype HTML>
<html>

<head>
    <title>Vehicles</title>
    <meta charset="utf-8">
</head>
<script src="../Assets/Scripts/scene.js"></script>
<script src="../Assets/Scripts/augmented.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>

<body style='margin : 0px; overflow: hidden;'>

    <a-scene embedded arjs='sourceType: webcam;'>

        <a-assets>
            <a-asset-item id="car" src="../Assets/Models/vehicles/generic_passenger_car_pack/scene.gltf">
            <a-asset-item id="bus" src="../Assets/Models/vehicles/bus/scene.gltf">
            <a-asset-item id="cycle" src="../Assets/Models/vehicles/cycle/scene.gltf">
        </a-assets>


        <!-- Using the asset management system. -->

        <!-- Car -->
        <a-marker preset='custom' type='pattern' id = "car-marker" url='../Assets/Markers/vehicles/car.patt'>
            <a-entity gltf-model="#car" position="0 0 0" scale="0.2 0.2 0.2" rotation="0 0 0"></a-entity>
        </a-marker>

        <!-- Bus -->
        <a-marker preset='custom' type='pattern' id = "bus-marker" url='../Assets/Markers/vehicles/bus.patt'>
            <a-entity gltf-model="#bus" position="0 0 0" scale="0.1 0.1 0.1" rotation="0 0 0"></a-entity>
        </a-marker>

        <!-- Cycle -->
        <a-marker preset='custom' type='pattern' id = "cycle-marker" url='../Assets/Markers/vehicles/cycle.patt'>
            <a-entity gltf-model="#cycle" position="0 0 0" scale="0.5 0.5 0.5" rotation="0 0 0"></a-entity>
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>

    <script>
		var bus = new Howl({
			src: ['../Assets/audio/vehicles_audio/bus.mp3']
		});
		var car = new Howl({
			src: ['../Assets/audio/vehicles_audio/car.mp3']
		});
        var cycle = new Howl({
			src: ['../Assets/audio/vehicles_audio/cycle.mp3']
		});

        window.onload = function () {
			const busMarker = document.getElementById('bus-marker');
			const carMarker = document.getElementById('car-marker');
            const cycleMarker = document.getElementById('cycle-marker');

			busMarker.addEventListener('markerFound', function() {
				bus.play();
			});
			busMarker.addEventListener('markerLost', function() {
				bus.stop();
			});
			carMarker.addEventListener('markerFound', function() {
				car.play(); 
			});
			carMarker.addEventListener('markerLost', function() {
				car.stop(); 
			});

            cycleMarker.addEventListener('markerFound', function() {
				cycle.play();
			});
			cycleMarker.addEventListener('markerLost', function() {
				cycle.stop();
			});
		}

	</script>

</body>

</html>